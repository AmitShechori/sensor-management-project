<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', path='css/main.css') }}">
    
    <title>Sensor Project - {{ title }}</title>

    <style>
        /* הגדרות בסיסיות למצב כהה */
        body.dark-mode { background-color: #121212; color: #e0e0e0; }
        .dark-mode .card, .dark-mode .content-section, .dark-mode .list-group-item { 
            background-color: #1e1e1e; border-color: #333; color: #e0e0e0; 
        }
        .dark-mode .card-header, .dark-mode .bg-light, .dark-mode thead { 
            background-color: #2d2d2d !important; color: #fff; 
        }
        .dark-mode .text-dark, .dark-mode h1, .dark-mode h2, .dark-mode h4 { color: #fff !important; }
        .dark-mode .table { color: #e0e0e0; }
    </style>
</head>
<body id="main-body">
    <header class="site-header">
      <nav class="navbar navbar-expand-md navbar-dark bg-steel fixed-top">
        <div class="container-fluid">
          <a class="navbar-brand mr-4" href="/">Sensor System</a>
          
          <div class="navbar-nav ml-auto flex-row">
            <button class="btn btn-sm btn-outline-light mr-2" onclick="setTheme('light')"><i class="fas fa-sun"></i></button>
            <button class="btn btn-sm btn-outline-light mr-2" onclick="setTheme('dark')"><i class="fas fa-moon"></i></button>
            <button class="btn btn-sm btn-outline-light" onclick="setTheme('auto')"><i class="fas fa-adjust"></i></button>
          </div>
        </div>
      </nav>
    </header>

    <main role="main" class="container-fluid mt-5 pt-4">
      {% block content %}{% endblock %}
    </main>

    <script>
        function setTheme(theme) {
            const body = document.getElementById('main-body');
            if (theme === 'dark') {
                body.classList.add('dark-mode');
                localStorage.setItem('theme', 'dark');
            } else if (theme === 'light') {
                body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'light');
            } else {
                // Auto mode - לפי שעת המערכת או הגדרות המחשב
                const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
                if (isDarkMode) body.classList.add('dark-mode');
                else body.classList.remove('dark-mode');
                localStorage.setItem('theme', 'auto');
            }
        }

        // טעינת ההגדרה השמורה בביקור הבא
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) setTheme(savedTheme);
    </script>
</body>
</html>